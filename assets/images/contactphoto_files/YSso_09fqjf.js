if (self.CavalryLogger) { CavalryLogger.start_js(["5x0TF"]); }

__d("ComposerXContextConfig",[],(function(a,b,c,d,e,f){e.exports={propertyNames:{actorID:"ACTOR_ID",postID:"POST_ID"},propertyValues:{ACTOR_ID:"actorID",POST_ID:"postID"}}}),null);
__d("ComposerXAttachmentBootstrap",["csx","cx","CSS","Form","FormSubmit","Parent","URI"],(function(a,b,c,d,e,f,g,h){__p&&__p();var i=[],j={bootstrap:function(a){j.load(b("Parent").byTag(a,"form"),a.getAttribute("data-endpoint"))},load:function(a,c,d){c=new(b("URI"))(c).addQueryData({composerurihash:j.getURIHash(c)});b("CSS").conditionClass(a,"_fu",d);d=b("Parent").bySelector(a,"._2_4");b("CSS").removeClass(d,"async_saving");b("Form").setDisabled(a,!1);a.action=c.toString();b("FormSubmit").send(a)},getURIHash:function(a){if(a==="initial")return"initial";var b=i.indexOf(a);if(b!==-1)return b+"";else{b=i.length;i[b]=a;return b+""}}};e.exports=j}),null);
__d("ComposerXContext",["invariant","ComposerXContextConfig"],(function(a,b,c,d,e,f,g){__p&&__p();var h=function(a){return b("ComposerXContextConfig").propertyNames[a]};function a(a){"use strict";this.$1={};for(var b in a)this.setProperty(b,a[b])}a.prototype.getProperty=function(a){"use strict";h(a)||g(0,undefined);return this.$1[a]};a.prototype.setProperty=function(a,b){"use strict";h(a)||g(0,undefined);this.$1[a]=b;return this};a.PROPERTIES=b("ComposerXContextConfig").propertyValues;e.exports=a}),null);
__d("ComposerXSessionIDInserter",["csx","ComposerXSessionIDs","DOM","DOMQuery","Event","Parent","onEnclosingPageletDestroy"],(function(a,b,c,d,e,f,g){__p&&__p();var h={init:function(a){var c=b("Event").listen(a,"submit",h._onSubmit);b("onEnclosingPageletDestroy")(a,function(){c.remove()})},_onSubmit:function(a){h.insertSessionInput(a.getTarget())},insertSessionInput:function(a){var c=b("Parent").bySelector(a,"._119");if(!c)return;c=b("ComposerXSessionIDs").getSessionID(c.id);if(!c)return;var d=b("DOMQuery").scry(a,"._5r_b")[0];!d?b("DOM").prependContent(a,b("ComposerXSessionIDs").createSessionIDInput(c)):d.value=c}};e.exports=h}),null);
__d("ComposerX",["csx","cx","ActorURI","Arbiter","ComposerXAttachmentBootstrap","ComposerXContext","ComposerXMarauderLogger","ComposerXSessionIDInserter","ComposerXSessionIDs","ComposerXStore","CSS","DOM","DOMQuery","PrivacyConst","PrivacySelector","PrivacySelectorNewDispatcher","SubscriptionsHandler","URI","getObjectValues","removeFromArray"],(function(a,b,c,d,e,f,g,h){__p&&__p();var i="any";function a(a){"use strict";this._root=a,this._composerID=a.id,this._attachments={},this._context=new(b("ComposerXContext"))({}),b("ComposerXSessionIDs").resetSessionID(this._composerID),b("ComposerXSessionIDInserter").init(this._root),this._subscriptionsHandler=new(b("SubscriptionsHandler"))(),this._subscriptionsHandler.addSubscriptions(b("Arbiter").subscribe(["composer/publish","composer/close"],function(c,d){if(d.composer_id===this._composerID){this.reset();c=b("DOMQuery").scry(a,".hidden_target_specs");c&&c.length&&c.forEach(b("DOM").remove);b("Arbiter").inform("composer/publishDone",d)}}.bind(this))),this._subscriptionsHandler.addSubscriptions.apply(this._subscriptionsHandler,b("ComposerXMarauderLogger").listenForPostEvents(this._composerID,this._getContent())),this._attachmentFetchForm=b("DOMQuery").find(a,"._2_4"),b("Arbiter").inform("composer/ready",{},"state")}a.prototype.getAttachment=function(a,c,d,e){"use strict";a=this._augmentURI(a);var f=b("ComposerXAttachmentBootstrap").getURIHash(a);this._endpointHashToShow=f;var g=this._attachments[f];g&&!e?this._showAttachmentAfterComponentsLoaded(f,d):this.fetchAttachmentData(a,c,e)};a.prototype.fetchAttachmentData=function(a,c,d){"use strict";a=this._augmentURI(a);var e=b("ComposerXAttachmentBootstrap").getURIHash(a);if(this._attachments[e]&&!d)return;this._currentFetchEndpoints.includes(e)||(b("ComposerXAttachmentBootstrap").load(this._attachmentFetchForm,a,c),this._currentFetchEndpoints.push(e))};a.prototype.setAttachment=function(a,c,d,e){"use strict";b("removeFromArray")(this._currentFetchEndpoints,a),this._setupAttachment(a,c,d,e),this._showAttachmentAfterComponentsLoaded(a,!1)};a.prototype.setInitialAttachment=function(a,c,d,e,f){"use strict";f&&(this._context=f);a=this._augmentURI(a);f=b("ComposerXAttachmentBootstrap").getURIHash(a);this._setupAttachment(f,c,d,e);this._initialAttachmentEndpoint=a;this._currentInstance||this._showAttachmentAfterComponentsLoaded(f,!0)};a.prototype.setComponent=function(a,c){"use strict";b("ComposerXStore").get(this._composerID,a)||(b("ComposerXStore").set(this._composerID,a,c),b("DOM").appendContent(this._attachmentFetchForm,b("DOM").create("input",{type:"hidden",name:"loaded_components[]",value:a})))};a.prototype.reset=function(){"use strict";__p&&__p();this._currentInstance&&(this._currentInstance.cleanup(),this._currentInstance=null);b("ComposerXSessionIDs").resetSessionID(this._composerID);for(var a in this._attachments)this._attachments[a].instance.reset();var c=b("ComposerXStore").getAllForComposer(this._composerID);b("getObjectValues")(c).forEach(function(a){a.reset&&a.reset(a)});c=b("PrivacySelector").getAdamaSelectorInstance(b("DOM").scry(this._root,"div._1lo2")[0]);var d=b("ComposerXStore").get(this._composerID,"mainprivacywidget");d=d&&d.instance&&d.instance.getInstance();c?d.setInstance(c):c=d&&d.getInstance();c&&c.shouldReplaceOnPost()&&b("PrivacySelectorNewDispatcher").handleUpdateFromSelector({selector_type:b("PrivacyConst").PrivacyField.CURRENT_COMPOSER.toString(),post_param:"",unique_id:"_reloadStickySelectors",reload:!0});this.getAttachment(this._initialAttachmentEndpoint,!1,!0);b("Arbiter").inform("composer/reset")};a.prototype.destroy=function(){"use strict";this._subscriptionsHandler.release()};a.prototype.addPlaceholders=function(a,b){"use strict";__p&&__p();var c;for(var d in this._attachments){c=this._attachments[d];if(c.instance===a){b.forEach(function(a){c.placeholders.push(a),c.required_components.push(a.component_name)});break}}this._currentInstance===a&&this._fillPlaceholders(b)};a.prototype.hasAttachmentWithClassName=function(a){"use strict";return b("DOMQuery").scry(this._root,"."+a).length>0};a.prototype.showAttachmentThrobber=function(){"use strict";b("CSS").addClass(this._attachmentFetchForm,"async_saving")};a.prototype.hideAttachmentThrobber=function(){"use strict";b("CSS").removeClass(this._attachmentFetchForm,"async_saving")};a.prototype.getContext=function(){"use strict";return this._context};a.prototype.getID=function(){"use strict";return this._composerID};a.prototype._setupAttachment=function(a,c,d,e){"use strict";c.setComposerID(this._composerID);this._attachments[a]={instance:c,placeholders:d,required_components:e};a=this._getContent();d=c.getRoot();d.parentNode!==a&&(b("CSS").hide(d),b("DOM").appendContent(a,d))};a.prototype._getContent=function(){"use strict";return b("DOMQuery").find(this._root,"div._55d0")};a.prototype._showAttachment=function(a,c,d,e){"use strict";__p&&__p();if(this._currentInstance===a)return;if(this._endpointHashToShow===i)this._endpointHashToShow=null;else if(this._endpointHashToShow!==c)return;if(this._currentInstance){if(!this._currentInstance.canSwitchAway())return;this._currentInstance.cleanup()}this._currentInstance=a;c=this._getContent().childNodes;var f=a.getRoot();for(var g=0;g<c.length;g++)c[g]!==f&&b("CSS").hide(c[g]);b("CSS").show(f);this._fillPlaceholders(d);a.initWithComponents(e);this._setAttachmentSelectedClass(a.attachmentClassName);b("Arbiter").inform("composer/initializedAttachment",{composerRoot:this._root,isInitial:e})};a.prototype._showAttachmentAfterComponentsLoaded=function(a,c){"use strict";var d=this._attachments[a];b("ComposerXStore").waitForComponents(this._composerID,d.required_components,this._showAttachment.bind(this,d.instance,a,d.placeholders,c))};a.prototype._fillPlaceholders=function(a){"use strict";a.forEach(function(a){var c=b("ComposerXStore").get(this._composerID,a.component_name);c.element&&a.element!==c.element.parentNode&&b("DOM").setContent(a.element,c.element)}.bind(this))};a.prototype._setAttachmentSelectedClass=function(a){"use strict";var c=b("DOMQuery").scry(this._root,"._519b")[0];c&&(b("CSS").removeClass(c,"_519b"),c=b("DOMQuery").scry(c,'*[aria-pressed="true"]')[0],c&&c.setAttribute("aria-pressed","false"));if(a){a=b("DOMQuery").scry(this._root,"."+a)[0];a&&(b("CSS").addClass(a,"_519b"),c=b("DOMQuery").scry(a,'*[aria-pressed="false"]')[0],c&&c.setAttribute("aria-pressed","true"))}};a.prototype._augmentURI=function(a){"use strict";var c=this._context.getProperty(b("ComposerXContext").PROPERTIES.ACTOR_ID);c=c?b("ActorURI").create(a,c):new(b("URI"))(a);a=this._context.getProperty(b("ComposerXContext").PROPERTIES.POST_ID);a&&c.addQueryData("post_id",a);return c.toString()};Object.assign(a.prototype,{_endpointHashToShow:i,_currentFetchEndpoints:[],_initialAttachmentEndpoint:""});e.exports=a}),null);
__d("ComposerXAttachment",["ComposerXStore"],(function(a,b,c,d,e,f){__p&&__p();a.prototype.getRoot=function(){"use strict"};a.prototype.initWithComponents=function(a){"use strict"};a.prototype.cleanup=function(){"use strict"};a.prototype.reset=function(){"use strict"};a.prototype.getComponent=function(a){"use strict";return b("ComposerXStore").get(this._composerID,a)};a.prototype.getComponentInstance=function(a){"use strict";a=b("ComposerXStore").get(this._composerID,a);return a&&a.instance};a.prototype.canSwitchAway=function(){"use strict";return!0};a.prototype.setComposerID=function(a){"use strict";this._composerID=a};a.prototype.getComposerID=function(){"use strict";return this._composerID};a.prototype.allowOGTagPreview=function(){"use strict";return!1};function a(){"use strict"}Object.assign(a.prototype,{attachmentClassName:""});e.exports=a}),null);
__d("registerForLeaveWarning",["fbt","Run","URI","createCancelableFunction"],(function(a,b,c,d,e,f,g){__p&&__p();function c(a){var c=b("URI").getNextURI(),d=b("createCancelableFunction")(a);b("Run").onBeforeUnload(function(){return h(d,c)});return d}function h(c,d){__p&&__p();var e=b("URI").getMostRecentURI(),f=b("URI").getNextURI();e=Object.prototype.hasOwnProperty.call(e.getQueryData(),"theater")&&d.path===f.path;var i=Object.prototype.hasOwnProperty.call(f.getQueryData(),"theater");f=a.DialogNavigationStack&&a.DialogNavigationStack.isActiveURI(f);if(e||i||f){b("Run").onAfterLoad(function(){b("Run").onBeforeUnload(function(){return h(c,d)})});return}if(a.Dialog&&a.Dialog.getCurrent())return;if(c())return g._("You haven't finished your post yet. Do you want to leave without finishing?")}e.exports=c}),null);
__d("ComposerXController",["csx","invariant","ActorURI","Arbiter","ComposerX","ComposerXAttachmentBootstrap","ComposerXContext","ComposerXMarauderLogger","Event","Parent","$","emptyFunction","ge","registerForLeaveWarning"],(function(a,b,c,d,e,f,g,h){__p&&__p();var i={},j={},k={};function l(a){var c=b("ge")(a);if(!c)return null;c=b("Parent").bySelector(b("$")(a),"._119");a=c.id;k[a]||(k[a]=new(b("ComposerX"))(c));return k[a]}function m(a){var b=l(a);b!==null||h(0,undefined,a);return b}function n(a){if(!j[a])return;j[a].forEach(function(a){return a.cancel()});delete j[a]}var o={registerConditionForComposerCancel:function(a,c){a=m(a).getID();a in i||(i[a]=[]);i[a].push(c);a in j||(j[a]=[]);j[a].push(b("registerForLeaveWarning")(c))},hasChanges:function(a){a=i[a];return!a?!1:a.some(function(a){return a()})},getAttachment:function(a,b,c,d){a=m(a);a.getAttachment(b,c,null,d)},fetchAttachmentData:function(a,b,c){m(a).fetchAttachmentData(b,c)},setAttachment:function(a,b,c,d,e){a=l(a);a&&a.setAttachment(b,c,d,e)},setInitialAttachment:function(a,b,c,d,e,f){a=m(a);a.setInitialAttachment(b,c,d,e,f)},setComponent:function(a,b,c){a=l(a);a&&a.setComponent(b,c)},reset:function(a){a=m(a);a.reset()},holdTheMarkup:b("emptyFunction"),getEndpoint:function(a,c,d){a=m(a);var e=a.getContext();c=b("ActorURI").create(c,e.getProperty(b("ComposerXContext").PROPERTIES.ACTOR_ID)).toString();b("ComposerXAttachmentBootstrap").load(a._attachmentFetchForm,c,d)},addPlaceholders:function(a,b,c){a=m(a);a.addPlaceholders(b,c)},hasAttachmentWithClassName:function(a,b){a=m(a);return a.hasAttachmentWithClassName(b)},showAttachmentThrobber:function(a){a=m(a);a.showAttachmentThrobber()},hideAttachmentThrobber:function(a){a=m(a);a.hideAttachmentThrobber()},logEventForElement:function(a,c){if(!b("Parent").bySelector(b("$")(a),"._119"))return;b("Event").listen(a,"click",function(){var d=o.getComposerID(a);b("ComposerXMarauderLogger").logEvent(c,d)})},getComposerID:function(a){return m(a).getID()},destroyComposer:function(a){if(!(a in k))return;k[a].destroy();delete k[a];delete i[a];n(a)}};b("ComposerXAttachmentBootstrap").bootstrap=function(a){o.getAttachment(a,a.getAttribute("data-endpoint"))};b("Arbiter").subscribe("page_transition",function(){for(var a in k)b("ge")(a)||o.destroyComposer(a)});e.exports=o}),null);
__d("ComposerXAttachmentButtonBarState",["csx","cx","CSS","DOMQuery"],(function(a,b,c,d,e,f,g,h){__p&&__p();var i={trackCityChanges:function(a){var b=a.getComponent("citysharericon");if(b)return b.instance.subscribe("change",function(){i.updateMessageBoxBarState(a)})},updateMessageBoxBarState:function(a){var c=a.getComponent("citysharericon");if(c){a=b("DOMQuery").find(a.getRoot(),"._1dsp");b("CSS").conditionClass(a,"_icv",!!c.instance.getValue())}}};e.exports=i}),null);
__d("ComposerXAttachmentPrefillMixin",["Event","InputSelection"],(function(a,b,c,d,e,f){a={_initPrefill:function(a,c){this._textArea=a,this._didInitialFocus=!1,this._prefill=c,this._prefill&&(this._focusListener=b("Event").listen(this._textArea,"focus",this._prefillOnFocus.bind(this)))},_resetPrefill:function(){this._didInitialFocus=!1},_prefillOnFocus:function(){!this._didInitialFocus&&this._prefill&&this._textArea.value===""&&(this._textArea.value=this._prefill,b("InputSelection").set(this._textArea,0,0)),this._didInitialFocus=!0}};e.exports=a}),null);
__d("ComposerXAttachmentUtils",["csx","Button","ComposerXController","DataStore","DOMQuery","Event","Focus","Keys","StickyPlaceholderInput","UserAgent_DEPRECATED"],(function(a,b,c,d,e,f,g){__p&&__p();var h="composer_fixed_placeholder";function i(a,c){b("DataStore").get(a.element,h,!1)||a.instance.setPlaceholder(c)}var j={initMentions:function(a,b,c,d){i(a,b.toString()),(!d||!d.dontFocusMentions)&&j.focusMentions(a),this.registerMentionsForComposerCancel(a,c)},focusMentions:function(a){a=b("DOMQuery").find(a.element,"textarea.input");b("Focus").set(a)},registerMentionsForComposerCancel:function(a,c){b("ComposerXController").registerConditionForComposerCancel(c,a.instance.hasChanges.bind(a.instance))},setValueForMentions:function(a,c){a=b("DOMQuery").find(a.element,"textarea.input");a.value=c},setStickyPlaceholderForMentions:function(a,b){i(a,b)},setPlaceholderIsFixed:function(a,c){b("DataStore").set(a.element,h,!!c)},setStickyPlaceholderForTypeahead:function(a,c){a=b("DOMQuery").find(a,".textInput");b("StickyPlaceholderInput").setPlaceholderText(a,c.toString())},listenForPostSubmission:function(a){b("Event").listen(a,"keydown",function(event){var c=event.getModifiers();c=b("UserAgent_DEPRECATED").osx()?c.meta:c.control;var d=b("DOMQuery").find(a.form,'._11b[type="submit"]');event.keyCode===b("Keys").RETURN&&c&&b("Button").isEnabled(d)&&(a.blur(),b("Event").fire(d,"click")&&b("Event").fire(a.form,"submit"),event.preventDefault())})}};e.exports=j}),null);
__d("AggregatedGroupStoryComposerTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(){this.clear()}a.prototype.log=function(){b("GeneratedLoggerUtils").log("logger:AggregatedGroupStoryComposerLoggerConfig",this.$1,b("Banzai").BASIC)};a.prototype.logVital=function(){b("GeneratedLoggerUtils").log("logger:AggregatedGroupStoryComposerLoggerConfig",this.$1,b("Banzai").VITAL)};a.prototype.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:AggregatedGroupStoryComposerLoggerConfig",this.$1,{signal:!0})};a.prototype.clear=function(){this.$1={};return this};a.prototype.getData=function(){return babelHelpers["extends"]({},this.$1)};a.prototype.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};a.prototype.setEvent=function(a){this.$1.event=a;return this};a.prototype.setVC=function(a){this.$1.vc=a;return this};c={event:!0,vc:!0};e.exports=a}),null);
__d("ComposerXAjaxEndpoint",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({ADS_MEDIA_UPLOAD:"/ajax/ads/create/composerx/attachment/media/upload/",ADS_ATTACHMENT_STATUS:"/ajax/ads/create/composerx/attachment/status/",MEDIA_UPLOAD:"/ajax/composerx/attachment/media/upload/",VIDEO_UPLOAD:"/ajax/composerx/attachment/video/upload/"})}),null);
__d("isAnimatedGif",["Promise"],(function(a,b,c,d,e,f){__p&&__p();var g=1e6;function h(a){return a[0]===71&&a[1]===73&&a[2]===70}function i(a,b){return a[b]===0&&a[b+1]===33&&a[b+2]===249&&a[b+3]===4&&a[b+8]===0&&(a[b+9]===44||a[b+9]===33)}function j(a){if(!h(a))return!1;var b=0;for(var c=0;c+9<a.length;++c){i(a,c)&&b++;if(b>1)return!0}return!1}function a(a){__p&&__p();return new(b("Promise"))(function(b){__p&&__p();var c=new FileReader();c.onloadend=function(a){if(a.target.readyState==FileReader.DONE){a=new Uint8Array(a.target.result);j(a)?b(!0):b(!1)}};c.onerror=function(a){b(!1)};var d=Math.min(g,a.size);d=a.slice(0,d);c.readAsArrayBuffer(d)})}e.exports=a}),null);
__d("ComposerXMediaUploadHandler",["fbt","Arbiter","AsyncRequest","ComposerXAjaxEndpoint","ComposerXController","CSS","Dialog","ImageExtensions","ReloadPage","SubscriptionsHandler","URI","VideoUploadConfig","VideoUploadFile","isAnimatedGif"],(function(a,b,c,d,e,f,g){__p&&__p();var h=b("ComposerXAjaxEndpoint").MEDIA_UPLOAD,i="/ajax/composerx/attachment/video/upload/",j=0;function k(a,b){"use strict";this.$1=a,this.$2=b}k.prototype.fetchAttachments=function(){"use strict";[this.getPhotoUploadAttachmentEndpoint(),i].forEach(function(a){b("ComposerXController").fetchAttachmentData(this.$1,a)}.bind(this))};k.prototype.handleFileSelected=function(a){"use strict";var b=this;k.isVideoOrAnimatedGifAsync(a,function(c){c?b.handleVideoSelected(a):b.handlePhotoSelected(a)})};k.canUploadAnimatedGIF=function(){"use strict";return b("ImageExtensions").GIF in b("VideoUploadConfig").videoExtensions};k.isVideoOrAnimatedGifAsync=function(a,c){"use strict";var d=b("VideoUploadFile").getExtensionFromFileInput(a.getInput());k.canUploadAnimatedGIF()&&d===b("ImageExtensions").GIF?b("isAnimatedGif")(a.getInput().files[0]).then(c):b("VideoUploadConfig").videoExtensions[d]?c(!0):c(!1)};k.prototype.handleVideoSelected=function(a){"use strict";if(this.$2&&this.$2.imagesOnly){var c=new(b("Dialog"))().setModal(!0).setButtons([b("Dialog").OK]);this.$2.isEditComposer?c.setTitle(g._("Can't add video")).setBody(g._("Sorry, you can't add a video to a post you're editing.")):c.setTitle(g._("Invalid Image File")).setBody(g._("Please upload a valid image file."));c.show();return}b("ComposerXController").getAttachment(this.$1,i);b("Arbiter").inform("ComposerXFilesStore/filesAdded/"+this.$1+"/videoupload",{fileInput:a},"persistent")};k.prototype.handlePhotoSelected=function(a){"use strict";b("ComposerXController").getAttachment(this.$1,this.getPhotoUploadAttachmentEndpoint()),k.$3(this.$1,a)};k.isVideoFile=function(a){"use strict";a=b("VideoUploadFile").getExtensionFromFileInput(a.getInput());return!!b("VideoUploadConfig").videoExtensions[a]};k.prototype.$4=function(){"use strict";return this.$2?this.$2.photoUploadOverrideEndpoint:null};k.prototype.getPhotoUploadAttachmentEndpoint=function(){"use strict";var a=this.$4();return a?a:h};k.$3=function(a,c){"use strict";b("Arbiter").inform("ComposerXFilesStore/filesAdded/"+a+"/mediaupload",{fileInput:c,receivedBySubscriber:!1},"persistent")};k.setupFileUploadToComposerDialog=function(a,c,d,e){"use strict";__p&&__p();var f="composerxmediauploadhandler"+j++,g=function(c){b("CSS").conditionClass(a.getControl(),d,c),a.getInput().disabled=c},h=new(b("URI"))(c),i=h.getQueryData();i.client_ref=f;h.setQueryData(i);c=h.toString();a.subscribe("change",function(){new(b("AsyncRequest"))().setURI(c).setErrorHandler(function(){a.clear(),g(!1)}).send(),g(!0)});b("Arbiter").subscribe("composer/dialog/"+f+"/new",function(c,d){this.$3(d.composerID,a);var f=new(b("SubscriptionsHandler"))();f.addSubscriptions(b("Arbiter").subscribe("composer/publish",function(event,a){e&&d.composerID===a.composer_id&&b("ReloadPage").now()}),d.dialog.subscribe("hide",function(){f.release(),a.clear(),g(!1)}))}.bind(this))};e.exports=k}),null);
__d("FirstPhotoUploadLogger",["csx","DOM","Event","PagesComposerActionsLogger","PagesComposerPostActionsLoggerEvent"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();a={log:function(event,a,c){if(!a||!c)return;c=b("DOM").scry(c,"._yr");if(c.length!==0&&event!==b("PagesComposerPostActionsLoggerEvent").DRAG_PHOTO_TO_COMPOSER)return;b("PagesComposerActionsLogger").log({event:event,target_id:a})},bindClickUpload:function(a,c,d){b("Event").listen(c,"click",function(){this.log(b("PagesComposerPostActionsLoggerEvent").CLICK_UPLOAD_PHOTO_IN_PHOTO_TAB,d,a)}.bind(this))}};e.exports=a}),null);
__d("ComposerXDragDrop",["fbt","Promise","Arbiter","ClipboardPhotoUploader","ComposerXAjaxEndpoint","ComposerXController","ComposerXDragDropUtils","ComposerXMediaUploadHandler","DragDropTarget","ErrorDialog","Event","FirstPhotoUploadLogger","PagesComposerPostActionsLoggerEvent","PUWMethods","URI","isAnimatedGif"],(function(a,b,c,d,e,f,g){__p&&__p();var h=b("ComposerXAjaxEndpoint").MEDIA_UPLOAD,i=b("ComposerXAjaxEndpoint").VIDEO_UPLOAD,j="/ajax/composerx/attachment/link/scraper/",k=function(a){a()};function a(a,c,d,e){"use strict";this._root=a,this._composerID=c,this._targetID=d,e=e||k,this._activatePasteHandler(),this._dragdrop=new(b("DragDropTarget"))(a).setOnFilesDropCallback(function(a){e(this._dropFiles.bind(this,a))}.bind(this)).setFileFilter(b("ComposerXDragDropUtils").filterImages).enable(),b("ComposerXDragDropUtils").handleDragEnterAndLeave(a),b("Arbiter").subscribe("composer/deactivateDragdrop",function(){this.deactivate()}.bind(this)),b("Arbiter").subscribe("composer/reactivateDragdrop",function(){this.reactivate()}.bind(this))}a.prototype.enableURLDropping=function(){"use strict";this._dragdrop.setOnURLDropCallback(this._onURLDrop.bind(this))};a.prototype.deactivate=function(){"use strict";this._dragdrop.disable(),this._deactivatePasteHandler()};a.prototype.reactivate=function(){"use strict";this._activatePasteHandler(),this._dragdrop.enable()};a.prototype._activatePasteHandler=function(){"use strict";if(this._pasteHandler)return;this._pasteHandler=b("Event").listen(this._root,"paste",function(event){var a=b("ClipboardPhotoUploader").getImages(event);if(!a.length)return;this._uploadFiles(a,b("PUWMethods").COPYPASTE)}.bind(this))};a.prototype._deactivatePasteHandler=function(){"use strict";if(!this._pasteHandler)return;this._pasteHandler.remove();delete this._pasteHandler};a.prototype._uploadFiles=function(a,c,d){"use strict";d?(b("ComposerXController").getAttachment(this._root,i),b("Arbiter").inform("ComposerXFilesStore/filesDropped/"+this._composerID+"/videoupload",{files:a},"persistent")):(b("ComposerXController").getAttachment(this._root,h),b("Arbiter").inform("ComposerXFilesStore/filesDropped/"+this._composerID+"/mediaupload",{files:a,method:c},"persistent"))};a.prototype._dropFiles=function(a){"use strict";__p&&__p();var c=a.map(function(a){return new(b("Promise"))(function(c){a.type==="image/gif"&&b("ComposerXMediaUploadHandler").canUploadAnimatedGIF()?c(b("isAnimatedGif")(a)):a.type.match("video/*")?c(!0):c(!1)})});for(var d=0;d<c.length;d++)if(c[d]._value===!1){b("FirstPhotoUploadLogger").log(b("PagesComposerPostActionsLoggerEvent").DRAG_PHOTO_TO_COMPOSER,this._targetID,this._root);break}b("Promise").all(c).then(function(c){this.validateMediaTypes(c)&&this._uploadFiles(a,b("PUWMethods").DRAGDROP,c[0])}.bind(this))};a.prototype._onURLDrop=function(a){"use strict";var c=new(b("URI"))(j);c.addQueryData({scrape_url:encodeURIComponent(a)});b("ComposerXController").getAttachment(this._root,c.toString())};a.prototype.validateMediaTypes=function(a){"use strict";__p&&__p();if(a.length>1){var c=!1,d=!1;for(var e=0;e<a.length;e++)a[e]?c=!0:d=!0;if(c&&d){b("ErrorDialog").show(g._("Can't upload both videos and images"),g._("Please select either one video or one or more images."));return!1}}return!0};e.exports=a}),null);
__d("PagesComposerEntryLogger",["Event","PagesEventObserver"],(function(a,b,c,d,e,f){__p&&__p();function a(a){"use strict";this.$1=a}a.prototype.registerForContentEntryEvents=function(a){"use strict";var c=function(){var a={page_id:this.$1,event_name:"composer_content_entry",pages_composer:1,target_id:this.$1};b("PagesEventObserver").logData_DEPRECATED(a,b("PagesEventObserver").VITAL_WAIT);this.unregister()};this.$2=b("Event").listen(a,{paste:c.bind(this),keydown:c.bind(this)})};a.prototype.unregister=function(){"use strict";if(!this.$2)return;for(var event in this.$2)this.$2[event].remove();this.$2=null};e.exports=a}),null);
__d("PrivacyRemindersLoggingTypes",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({ONLY_ME_IMPRESSION:"only_me_impression",ONLY_ME_CONVERSION:"only_me_conversion",EVERYONE_IMPRESSION:"everyone_impression",EVERYONE_CONVERSION:"everyone_conversion",EVERYONE_TESTS_IMPRESSION:"everyone_tests_impression",EVERYONE_TESTS_CONVERSION:"everyone_tests_conversion",PUBLIC_POSTING_FILTER_NUX_IMPRESSION:"public_posting_filter_nux_impression",PUBLIC_POSTING_FILTER_NUX_CONVERSION:"public_posting_filter_nux_conversion",DELTA_EVERYONE_IMPRESSION:"delta_everyone_impression",DELTA_EVERYONE_CONVERSION:"delta_everyone_conversion",DELTA_EVERYONE_OK_BUTTON_CLICKED:"delta_everyone_ok_button_clicked",DELTA_EVERYONE_CHANGE_BUTTON_CLICKED:"delta_everyone_change_button_clicked"})}),null);
__d("SuggestionConfig",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({GROUP_POST_COMPOSER:"grouppostcomposer",OG_SUGGESTION_BY_INPUT:"ogsuggestionbyinput",COMPOSER_ENTRY_BOOTSTRAP:"composerentrybootstrap",MTOUCH_COMPOSER_ENTRY_BOOTSTRAP:"mtouchcomposerentrybootstrap",MTOUCH_COMPOSER_LOAD_VERBS:"mtouchcomposerloadverbs"})}),null);
__d("SuggestionUIPresentation",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({FLYOUT:1,TAGGER_BADGE:2,ADD_TAG:3,SEMI_INLINE:4,TOP_OF_VERBS:5})}),null);
__d("XPrivacyRemindersDismissController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/privacy/reminders/dismiss/",{type:{type:"String",required:!0},log_plite:{type:"Bool",defaultValue:!1}})}),null);
__d("XPrivacyRemindersImpressionLoggingController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/privacy/reminders/log_imp/",{type:{type:"String",required:!0}})}),null);
__d("ComposerXBootloadStatusAttachment",["csx","cx","fbt","AggregatedGroupStoryComposerTypedLogger","Arbiter","AsyncRequest","Bootloader","ComposerEntryPointRef","ComposerXAttachment","ComposerXAttachmentButtonBarState","ComposerXAttachmentPrefillMixin","ComposerXAttachmentUtils","ComposerXController","ComposerXDragDrop","ComposerXDragDropUtils","ComposerXMarauderLogger","ComposerXStore","CSS","DOM","DOMQuery","Event","Focus","requireWeak","NoNewerStoryInsertionWhileComposingGK","PageTransitions","PagesComposerEntryLogger","Parent","FocusListener","PrivacyConst","PrivacyRemindersLoggingTypes","SelectorDeprecated","SubscriptionsHandler","SuggestionConfig","SuggestionUIPresentation","URI","XUIError","classWithMixins","createCancelableFunction","getActiveElement","mixin","requestAnimationFrame","XPrivacyRemindersDismissController","XPrivacyRemindersImpressionLoggingController","XReactComposerLoggingODSController"],(function(a,b,c,d,e,f,g,h,i){__p&&__p();var j,k;b("requireWeak")("LitestandStoryInsertionStatus",function(a){k=a});var l={only_me:{PRIVACY_CONSTANT:[b("PrivacyConst").BaseValue.SELF],LOG_IMPRESSION:b("PrivacyRemindersLoggingTypes").ONLY_ME_IMPRESSION,LOG_CONVERSION:b("PrivacyRemindersLoggingTypes").ONLY_ME_CONVERSION,LOG_IMPRESSION_TO_DISMISS_ENDPOINT:!0},everyone:{PRIVACY_CONSTANT:[b("PrivacyConst").BaseValue.EVERYONE],LOG_IMPRESSION:b("PrivacyRemindersLoggingTypes").EVERYONE_IMPRESSION,LOG_CONVERSION:b("PrivacyRemindersLoggingTypes").EVERYONE_CONVERSION,LOG_IMPRESSION_TO_DISMISS_ENDPOINT:!0},everyone_tests:{PRIVACY_CONSTANT:[b("PrivacyConst").BaseValue.EVERYONE],LOG_IMPRESSION:b("PrivacyRemindersLoggingTypes").EVERYONE_TESTS_IMPRESSION,LOG_CONVERSION:b("PrivacyRemindersLoggingTypes").EVERYONE_TESTS_CONVERSION,LOG_IMPRESSION_TO_DISMISS_ENDPOINT:!0},public_posting_filter_nux:{PRIVACY_CONSTANT:[b("PrivacyConst").BaseValue.EVERYONE],LOG_IMPRESSION:b("PrivacyRemindersLoggingTypes").PUBLIC_POSTING_FILTER_NUX_IMPRESSION,LOG_CONVERSION:b("PrivacyRemindersLoggingTypes").PUBLIC_POSTING_FILTER_NUX_CONVERSION,LOG_IMPRESSION_TO_DISMISS_ENDPOINT:!0}},m={};c=babelHelpers.inherits(a,b("classWithMixins")(b("ComposerXAttachment"),b("mixin")(b("ComposerXAttachmentPrefillMixin"))));j=c&&c.prototype;function a(a,c){"use strict";j.constructor.call(this),this._onSelectorChange=function(a,b){if(!this.getComponent("mainprivacywidget"))return;(this._newPrivacyWidgetInstance||b.selector===this._privacyWidgetElement.firstChild)&&setTimeout(function(){Object.keys(this._privacyReminders).forEach(this._showPrivacyReminder,this)}.bind(this))}.bind(this),this._root=a,this._config=c,this._privacyReminders={},k&&b("NoNewerStoryInsertionWhileComposingGK").no_insertion_while_composing&&k.registerBlocker(function(){return this._isFocused()}.bind(this))}a.prototype.getRoot=function(){"use strict";return this._root};a.prototype.getPrivacyInstance=function(){"use strict";return this._newPrivacyWidgetInstance};a.prototype._getTextArea=function(){"use strict";return b("DOMQuery").find(this.getComponent("maininput").element,"textarea.input")};a.prototype.initWithComponents=function(a){"use strict";__p&&__p();m[this._composerID]=this;this._attachmentIsActive=!0;var c=this._getTextArea(),d=b("DOMQuery").scry(b("Parent").bySelector(this.getRoot(),"._119"),"li."+this.attachmentClassName)[0];this._focusListener=b("Event").listen(c,"focus",this._onFocus.bind(this,"area_focus"));this._config.prefill_text&&this._initPrefill(c,this._config.prefill_text);a&&this._config.targetIsPage&&(this._pagesComposerEntryLogger=new(b("PagesComposerEntryLogger"))(this._config.targetID),this._pagesComposerEntryLogger.registerForContentEntryEvents(c));this._fullVersion?this._fullInitWithComponents():this._bootloading||(this._isFocused()?this._onFocus("is_focused"):d&&(this._clickListener=b("Event").listen(d,"click",function(){b("Focus").set(c)}.bind(this))));this._dragEnterHandler=b("Arbiter").subscribe("dragenter",function(a,d){__p&&__p();if(d.element==this._root){b("Arbiter").inform("composerprivacy/aborteducation");a=d.event.dataTransfer.items;var e;a&&(e=b("ComposerXDragDropUtils").filterImages(a));if(e&&e.length>0)b("Focus").set(c);else{d=b("Parent").byClass(this._root,"focus_target");b("FocusListener").expandInput(d);this._onFocus("drag_focus")}}}.bind(this));this.getComponent("maininput").instance.setPlaceholder(this._config.mentionsPlaceholder);a||b("Focus").set(c);this._dragdrop=new(b("ComposerXDragDrop"))(this._root,this._composerID,this._config.targetID);this._dragdrop.enableURLDropping();this._initPrivacyWidgetInstance();this._config.postActionsButton!=null&&this._config.postActionsButton.initHiddenInputs(this.getComponent("pabhiddeninputs").instance);b("PageTransitions").registerHandler(this.cleanup.bind(this))};a.prototype._initPrivacyWidgetInstance=function(){"use strict";__p&&__p();var a=this.getComponent("mainprivacywidget");if(!a)return;this._privacyWidgetElement=a.element;this._newPrivacyWidgetInstance=a.instance&&a.instance.getInstance().getInstance();if(this._newPrivacyWidgetInstance){a=this.getComponent("maininput").instance&&this.getComponent("maininput").instance.getMentions();var b=this.getComponent("tagExpansionButton");b&&b.instance&&b.instance.listenToPrivacy(this._newPrivacyWidgetInstance,a)}};a.prototype._fullInitWithComponents=function(a){"use strict";this._bootloadCallback=b("createCancelableFunction")(this._bootloadModules.bind(this)),b("Bootloader").loadModules(["ComposerXPrivacyWidgetTags","URLScraper","SuggestionScraper"],this._bootloadCallback,"ComposerXBootloadStatusAttachment"),Object.keys(this._privacyReminders).forEach(this._showPrivacyReminder,this),this._setEveryonePrivacyImpression&&this._showPrivacyReminder("everyone"),this._newPrivacyWidgetInstance?this._newPrivacyWidgetInstance.subscribe("changed",this._onSelectorChange):b("SelectorDeprecated").subscribe("select",this._onSelectorChange),b("Arbiter").inform("ComposerXBootloadStatusAttachment/mutate")};a.prototype._bootloadModules=function(a,c,d){"use strict";__p&&__p();this._modulesAreBootloaded=!0;this._tagger.init(this);this._privacyWidgetTags=new a(this);b("ComposerXAttachmentButtonBarState").trackCityChanges(this);a=b("DOMQuery").find(this.getComponent("maininput").element,"textarea.input");this._scraper||(this._scraper=new c(a),this._scraper.subscribe("match",function(a,c){a=this._getScraperEndpoint();a.addQueryData({scrape_url:encodeURIComponent(c.url),remove_url:this._config.remove_url,attachment_class:this._config.classname});c=this._config.isCarouselComposer;b("ComposerXController").getAttachment(this._root,a.toString(),null,c)}.bind(this)));this._scraper.enable();this._scraper.check();c=b("DOM").scry(this._root,"._4-jj");a=this.getComposerID();this._config.stream_context==="home"&&c&&c.length&&this._tagger&&a&&(this._suggestionScraper||(this._suggestionScraper=new d(this._tagger,c[0],[b("SuggestionUIPresentation").SEMI_INLINE,b("SuggestionUIPresentation").TAGGER_BADGE,b("SuggestionUIPresentation").TOP_OF_VERBS],a),this._suggestionScraper.setBootloadTriggerConfig(b("SuggestionConfig").COMPOSER_ENTRY_BOOTSTRAP)))};a.prototype._showPrivacyReminder=function(a){"use strict";__p&&__p();var c=this,d=this._privacyReminders[a],e=l[a],f;this._newPrivacyWidgetInstance?f=this._newPrivacyWidgetInstance.getSelectedBaseValue():f=parseInt(b("SelectorDeprecated").getValue(this._privacyWidgetElement),10);if(!d||!d.dialog||d.shown){f===b("PrivacyConst").BaseValue.EVERYONE&&this._setEveryonePrivacyImpression&&(this._sendSetEveryonePrivacyImpression(),this._setEveryonePrivacyImpression=!1);return}if(e.PRIVACY_CONSTANT.indexOf(f)===-1)return;d.dialog.setContext(this._privacyWidgetElement).show();d.shown=!0;this._privacyReminderShown=!0;if(e.LOG_IMPRESSION){f=b("XPrivacyRemindersImpressionLoggingController").getURIBuilder().setString("type",e.LOG_IMPRESSION).getURI();new(b("AsyncRequest"))(f).send()}if(e.LOG_IMPRESSION_TO_DISMISS_ENDPOINT)if(a==="only_me"){f=b("XPrivacyRemindersDismissController").getURIBuilder().setString("type",a).getURI();new(b("AsyncRequest"))(f).send()}else new(b("AsyncRequest"))("/ajax/privacy/reminders/dismiss").setData({type:a,dismiss_type:"impression"}).send();f=function(event){__p&&__p();var e=b("CSS").hasClass(event.target,"layerConfirm")||b("DOMQuery").scry(event.target,"^.layerConfirm").length===1,f=b("CSS").hasClass(event.target,"layerButton")||b("DOMQuery").scry(event.target,"^.layerButton").length===1;if(e&&a!=="public_posting_filter_nux"){if(a==="only_me"){e=b("XPrivacyRemindersImpressionLoggingController").getURIBuilder().setString("type",b("PrivacyRemindersLoggingTypes").DELTA_EVERYONE_OK_BUTTON_CLICKED).getURI();new(b("AsyncRequest"))(e).send()}return}if(a==="only_me"){e=b("XPrivacyRemindersDismissController").getURIBuilder().setString("type",a).getURI();new(b("AsyncRequest"))(e).send()}else new(b("AsyncRequest"))("/ajax/privacy/reminders/dismiss").setData({type:a,hide:f}).send();d.events.forEach(function(a){a.remove()});d.events=[];d.dialog.hide();this._privacyReminderShown=!1;f&&b("requestAnimationFrame")(function(){this._newPrivacyWidgetInstance?this._newPrivacyWidgetInstance.openSelector():b("SelectorDeprecated").toggle(b("DOMQuery").scry(c.getComponent("mainprivacywidget").element,".uiSelector")[0])}.bind(this))}.bind(this);this._newPrivacyWidgetInstance?d.conversionListener=this._newPrivacyWidgetInstance.subscribe("changed",function(a,b){a=this._newPrivacyWidgetInstance.getSelectedBaseValue();this._logPrivacyReminderConversion(d,e,a)}.bind(this)):d.conversionListener=b("SelectorDeprecated").subscribe("select",function(a,c){if(c.selector==this._privacyWidgetElement.firstChild){a=parseInt(b("SelectorDeprecated").getValue(c.option),10);this._logPrivacyReminderConversion(d,e,a)}}.bind(this));d.events=[b("Event").listen(d.dialog.getContent(),"click",f),b("Event").listen(d.dialog.getContext(),"click",f)]};a.prototype._logPrivacyReminderConversion=function(a,c,d){"use strict";if(c.PRIVACY_CONSTANT.indexOf(d)===-1){if(c.LOG_CONVERSION){d=b("XPrivacyRemindersImpressionLoggingController").getURIBuilder().setString("type",c.LOG_CONVERSION).getURI();new(b("AsyncRequest"))(d).send()}this._newPrivacyWidgetInstance?this._newPrivacyWidgetInstance.unsubscribe(a.conversionListener):b("SelectorDeprecated").unsubscribe(a.conversionListener);a.conversionListener=null}};a.prototype.cleanup=function(){"use strict";this._attachmentIsActive=!1,this._focusListener&&(this._focusListener.remove(),this._focusListener=null),this._clickListener&&(this._clickListener.remove(),this._clickListener=null),Object.keys(l).forEach(function(a){a=this._privacyReminders[a];a&&a.dialog&&a.shown&&(a.dialog.hide(),a.events.forEach(function(a){a.remove()}),a.events=[],a.conversionListener&&(this._newPrivacyWidgetInstance?this._newPrivacyWidgetInstance.unsubscribe(a.conversionListener):b("SelectorDeprecated").unsubscribe(a.conversionListener)),a.conversionListener=null)}.bind(this)),this._dragdrop&&(this._dragdrop.deactivate(),this._dragdrop=null),this._modulesAreBootloaded&&(this._tagger.cleanup(),this._privacyWidgetTags&&(this._privacyWidgetTags.destroy(),this._privacyWidgetTags=null),this._scraper.disable()),this._bootloadCallback&&(this._bootloadCallback.cancel(),this._bootloadCallback=null),this._dragEnterHandler&&(this._dragEnterHandler.unsubscribe(),this._dragEnterHandler=null),this._pagesComposerEntryLogger&&this._pagesComposerEntryLogger.unregister()};a.prototype.reset=function(){"use strict";var a=b("Parent").bySelector(this._root,".child_was_focused");a&&b("CSS").removeClass(a,"child_was_focused");this._tagger&&this._tagger.reset();this._scraper&&this._scraper.reset();this._newPrivacyWidgetInstance&&this._newPrivacyWidgetInstance.informTagsChanged([]);this.getComponent("maininput").instance.setPlaceholder(this._config.mentionsPlaceholder);this._config.prefill_text&&this._resetPrefill()};a.prototype.canSwitchAway=function(){"use strict";return!b("Parent").byClass(this._root,"async_saving")};a.prototype.bootloadAttachments=function(){"use strict";if(this._bootloading)return;this._bootloading=!0;b("ComposerXController").getEndpoint(this._root,"/ajax/composerx/attachment/status/bootload/",!0)};a.prototype.setBootloadedContent=function(a){"use strict";__p&&__p();this._bootloading=!1;this._setEveryonePrivacyImpression=!!a.set_everyone_privacy_impression;Object.keys(l).forEach(function(b){var c=a[b+"_privacy_reminder"];c&&(this._privacyReminders[b]={dialog:c})}.bind(this));if(a.markup.privacy_widget){var c=b("DOMQuery").find(this._root,"._etn");b("DOM").setContent(c,a.markup.privacy_widget);c=b("DOMQuery").find(this._root,"._1dwm");c&&(c.disabled=!1,b("CSS").removeClass(c,"_42fr"))}c=a.placeholders.map(function(a){return a.component_name});b("ComposerXStore").waitForComponents(this._composerID,c,function(){__p&&__p();var c=b("DOMQuery").find(this._root,"._3-6"),d=b("DOMQuery").find(this._root,"._3-7");b("DOM").setContent(c,a.markup.tagger_content);b("DOM").setContent(d,a.markup.tagger_icons);a.markup.privacy_widget&&this._initPrivacyWidgetInstance();b("ComposerXController").addPlaceholders(this._root,this,a.placeholders);this._tagger=a.tagger;b("ComposerXAttachmentButtonBarState").updateMessageBoxBarState(this);this._fullVersion=!0;this._attachmentIsActive&&this._fullInitWithComponents(a);b("ComposerXAttachmentUtils").registerMentionsForComposerCancel(this.getComponent("maininput"),this.getComposerID())}.bind(this));c=b("XReactComposerLoggingODSController").getURIBuilder().setString("event","bootload_done").setEnum("composer_type",b("ComposerEntryPointRef").LEGACY_FEED).getURI();new(b("AsyncRequest"))(c).send()};a.prototype._getScraperEndpoint=function(){"use strict";return new(b("URI"))("/ajax/composerx/attachment/link/scraper/")};a.prototype._isFocused=function(){"use strict";return b("DOMQuery").contains(this._root,b("getActiveElement")())};a.prototype._isEditing=function(){"use strict";return this._isFocused()||this.getComponent("maininput").instance.hasChanges()};a.prototype._onFocus=function(a){"use strict";this._config.is_group_aggregated_story&&a==="area_focus"&&new(b("AggregatedGroupStoryComposerTypedLogger"))().setEvent("click").log();b("ComposerXMarauderLogger").logEntry(this._composerID);this._prefillOnFocus();if(this._fullVersion||this._bootloading)return;b("Arbiter").inform("composer/focus",this._composerID);b("Arbiter").inform("composer/render_pab_nux");this.bootloadAttachments()};a.prototype.allowOGTagPreview=function(){"use strict";return!0};a.prototype._sendSetEveryonePrivacyImpression=function(){"use strict";new(b("AsyncRequest"))("/ajax/privacy/reminders/set_everyone_privacy_impression").send()};a.prototype.onEmptyStatusCallback=function(){"use strict";var a=this._getTextArea();b("Focus").set(a);b("XUIError").set({target:a,message:i._("This status update appears to be blank. Please write something or attach a link or photo to update your status."),position:"below",alignh:"left"});new(b("SubscriptionsHandler"))().addSubscriptions(b("Event").listen(this.getRoot(),"success",function(){b("XUIError").clear(this._getTextArea())}.bind(this)),b("Arbiter").subscribe("composer/publish",function(event,a){if(a.composer_id!=this.getComposerID())return;b("XUIError").clear(this._getTextArea())}.bind(this)))};a.setBootloadedContent=function(a,b){"use strict";a=m[a];a&&a.setBootloadedContent.call(a,b)};a.onEmptyStatusListener=function(a){"use strict";a=m[a];a&&a.onEmptyStatusCallback.call(a)};Object.assign(a.prototype,{_attachmentIsActive:!1,_bootloading:!1,_modulesAreBootloaded:!1,_fullVersion:!1,_focusListener:null,_privacyWidgetTags:null,_scraper:null,_dragdrop:null,_bootloadCallback:null,attachmentClassName:"_4j"});e.exports=a}),null);
__d("ComposerXMentionsInputReset",["DOMQuery","Input"],(function(a,b,c,d,e,f){function a(a){var c=b("DOMQuery").scry(a.element,"textarea.input")[0];a.instance.reset();b("Input").reset(c)}e.exports=a}),null);
__d("ComposerXOGTaggerIconReset",["cx","CSS"],(function(a,b,c,d,e,f,g){function a(a){b("CSS").removeClass(a.element,"_4-jh"),b("CSS").removeClass(a.element,"_509o")}e.exports=a}),null);
__d("ComposerXTaggerIconReset",["cx","CSS"],(function(a,b,c,d,e,f,g){function a(a){b("CSS").removeClass(a.element,"_1dsa"),b("CSS").removeClass(a.element,"_1dsb"),b("CSS").removeClass(a.element,"_509o")}e.exports=a}),null);
__d("ComposerXPostSubmitButtonActions",["cx","Arbiter","CSS"],(function(a,b,c,d,e,f,g){function a(a){"use strict";b("Arbiter").subscribe("composer/disablePostButton",function(event,c){c.disabled?b("CSS").addClass(a,"_2dha"):b("CSS").removeClass(a,"_2dha")})}e.exports=a}),null);
__d("BucketedTypeaheadView",["fbt","DOM","TypeaheadView"],(function(a,b,c,d,e,f,g){__p&&__p();var h,i;h=babelHelpers.inherits(a,b("TypeaheadView"));i=h&&h.prototype;a.prototype.render=function(a,b,c,d){"use strict";__p&&__p();var e=b.length>0;for(var f=0;f<b.length;++f)b[f].type!=="hashtag"&&(e=!1);e||(b=this.buildBuckets(a,b));if(c&&d){f=this.results.length-this.index;this.index=b.length-f}return i.render.call(this,a,b,c)};a.prototype.highlight=function(a,b){"use strict";this.headerIndex=!1;a==-1&&this.index!==0&&(a=this.index);while(a>=0&&a<this.items.length&&!this.isHighlightable(this.results[a]))a=a+1,this.headerIndex=!0;i.highlight.call(this,a,b)};a.prototype.buildBuckets=function(a,b){"use strict";__p&&__p();if(!this.typeObjects||!b||!b.length)return b;a=[];var c={};for(var d=0;d<b.length;++d){var e=b[d],f=e.render_type||e.type;Object.prototype.hasOwnProperty.call(c,f)||(c[f]=a.length,a.push([this.buildBucketHeader(f)]));e.classNames=e.classNames||f;e.groupIndex=c[f];e.indexInGroup=a[e.groupIndex].length-1;e.globalIndex=d;a[e.groupIndex].push(e)}for(f in this.typeObjects)!Object.prototype.hasOwnProperty.call(c,f)&&this.typeObjects[f].show_always&&(c[f]=a.length,a.push([this.buildBucketHeader(f)]),e=this.buildNoResultsEntry(),e.classNames=e.type,e.groupIndex=c[f],e.indexInGroup=a[e.groupIndex].length-1,a[e.groupIndex].push(e));d=[];if(this.typeObjectsOrder)for(var b=0;b<this.typeObjectsOrder.length;++b){e=this.typeObjectsOrder[b];Object.prototype.hasOwnProperty.call(c,e)&&(d=d.concat(a[c[e]]))}else for(var f=0;f<a.length;++f)d=d.concat(a[f]);return d};a.prototype.buildNoResultsEntry=function(){"use strict";return{uid:"disabled_result",type:"disabled_result",text:g._("No Results")}};a.prototype.buildBucketHeader=function(a){"use strict";var b=this.typeObjects[a];if(b===undefined)throw new Error(a+" is undefined in "+JSON.stringify(this.typeObjects));b.markup&&(b.text=b.markup,delete b.markup);return this.typeObjects[a]};a.prototype.buildResults=function(a){"use strict";a=i.buildResults.call(this,a);if(this.typeObjects)return b("DOM").create("div",{className:"bucketed"},[a]);else return a};a.prototype.isHighlightable=function(a){"use strict";return a.type!="header"&&a.type!="disabled_result"};a.prototype.select=function(a){"use strict";var b=this.results[this.index];b&&this.isHighlightable(b)&&i.select.call(this,a)};a.prototype.updateResults=function(a){"use strict";this.results=a};a.prototype.normalizeIndex=function(a){"use strict";var b=this.results.length;if(b===0)return-1;else if(a<-1)return a%b+b+1;else if(a>=b)return a%b-1;else return a};a.prototype.getDefaultIndex=function(a){"use strict";__p&&__p();var b=this.autoSelect&&!this.disableAutoSelect;if(this.index<0&&!b)return-1;if(a.length===0)return-1;b=0;while(!this.isHighlightable(a)&&b<a.length)b++;return b};a.prototype.prev=function(){"use strict";var a=this.results[this.normalizeIndex(this.index-1)];while(a&&!this.isHighlightable(a))this.index=this.normalizeIndex(this.index-1),a=this.results[this.normalizeIndex(this.index-1)];return i.prev.call(this)};a.prototype.next=function(){"use strict";var a=this.results[this.normalizeIndex(this.index+1)];while(a&&!this.isHighlightable(a))this.index=this.normalizeIndex(this.index+1),a=this.results[this.normalizeIndex(this.index+1)];return i.next.call(this)};function a(){"use strict";h.apply(this,arguments)}e.exports=a}),null);
__d("ContextualTypeaheadView",["BucketedTypeaheadView","ContextualLayer","ContextualLayerAutoFlip","ContextualLayerHideOnScroll","CSS","DOM","DOMDimensions","Style"],(function(a,b,c,d,e,f){__p&&__p();var g,h;g=babelHelpers.inherits(a,b("BucketedTypeaheadView"));h=g&&g.prototype;a.prototype.init=function(){"use strict";this.initializeLayer(),h.init.call(this)};a.prototype.initializeLayer=function(){"use strict";this.context=this.getContext(),this.wrapper=b("DOM").create("div"),b("DOM").appendContent(this.wrapper,this.element),b("CSS").addClass(this.element,"uiContextualTypeaheadView"),this.layer=new(b("ContextualLayer"))({context:this.context,position:"below",alignment:this.alignment,causalElement:this.causalElement,permanent:!0,shouldSetARIAProperties:!1},this.wrapper),this.layer.enableBehavior(b("ContextualLayerHideOnScroll")),(b("Style").isFixed(this.context)||this.autoflip)&&this.layer.enableBehavior(b("ContextualLayerAutoFlip")),this.subscribe("render",this.renderLayer.bind(this))};a.prototype.show=function(){"use strict";this.minWidth?b("Style").set(this.wrapper,"min-width",this.minWidth+"px"):this.width?b("Style").set(this.wrapper,"width",this.width+"px"):b("Style").set(this.wrapper,"width",b("DOMDimensions").getElementDimensions(this.context).width+"px");var a=h.show.call(this);this.layer.show();this.inform("show");return a};a.prototype.hide=function(){"use strict";this.layer.hide();this.inform("hide");return h.hide.call(this)};a.prototype.renderLayer=function(){"use strict";if(!this.isVisible())return;this.layer.isShown()?this.layer.updatePosition():this.layer.show()};a.prototype.clearText=function(){"use strict";this.layer.getCausalElement().value=""};a.prototype.getContext=function(){"use strict";return this.element.parentNode};function a(){"use strict";g.apply(this,arguments)}e.exports=a}),null);
__d("TypeaheadBestName",["FamilyMentionsData","TokenizeUtil"],(function(a,b,c,d,e,f){__p&&__p();function a(a){"use strict";this._typeahead=a}a.prototype.enable=function(){"use strict";var a=this._typeahead.getView(),b=this._getAvailableAlternateNameFields();this._subscription=a.subscribe("beforeRender",function(a,c){a=c.value;for(var d=0;d<c.results.length;++d){var e=c.results[d],f=this._getNameToDisplay(e,a,b);f!==null&&(e.text=f,Object.prototype.hasOwnProperty.call(e,"default_name")&&e.text!==e.default_name?e.subtext=e.default_name:e.subtext=null)}}.bind(this))};a.prototype.disable=function(){"use strict";this._typeahead.getView().unsubscribe(this._subscription),this._subscription=null};a.prototype._getNameToDisplay=function(a,c,d){"use strict";__p&&__p();if(Object.prototype.hasOwnProperty.call(a,"default_name")&&b("TokenizeUtil").isQueryMatch(c,a.default_name))return a.default_name;for(var e=0;e<d.length;e++){var f=a[d[e]];if(f==undefined)continue;for(var g=0;g<f.length;g++){var h=f[g];if(b("TokenizeUtil").isQueryMatch(c,h))return h}}return Object.prototype.hasOwnProperty.call(a,"default_name")?a.default_name:null};a.prototype._getAvailableAlternateNameFields=function(){"use strict";var a=["alternate_names"];b("FamilyMentionsData").allowFamilyNames&&a.push("family_names");return a};Object.assign(a.prototype,{_subscription:null});e.exports=a}),null);
__d("legacy:BestNameTypeaheadBehavior",["TypeaheadBestName"],(function(a,b,c,d,e,f){a.TypeaheadBehaviors||(a.TypeaheadBehaviors={}),a.TypeaheadBehaviors.buildBestAvailableNames=function(a){a.enableBehavior(b("TypeaheadBestName"))}}),3);
__d("MentionsInputMatchers",[],(function(a,b,c,d,e,f){__p&&__p();b=["@","\\uff20"].join("");var g=["#","\\uFF03"].join("");c=".,+*?$|#{}()\\^\\-\\[\\]\\\\/!%'\"~=<>_:;\n\r";d=c.replace("#","")+"&";var h="\u200b";function a(a,b){"use strict";this.$1=a,this.$2=b,this.$3()}a.prototype.$3=function(){"use strict";__p&&__p();var a=this.$4(this.$2),b=this.$5(this.$1,this.$2);b=this.$6(this.$1,b);var c=this.$7(a,b);a=this.$8(a);this.$9=new RegExp("["+this.$1+"]$");this.$10=new RegExp(b+"$");this.$11=new RegExp(a+"$");this.$12=new RegExp(c+"$");this.$13=new RegExp("["+g+"]")};a.prototype.$4=function(a){"use strict";return"\\b[A-Z][^ A-Z"+a+h+"]"};a.prototype.$5=function(a,b){"use strict";return"(?:[^"+a+b+"]|["+b+"][^ "+b+"])"};a.prototype.$6=function(a,b){"use strict";return"(?:^|\\s)(["+a+"]("+b+"{0,20}))"};a.prototype.$7=function(a,b){"use strict";return"(?:(?:^|[^#])("+a+"+)|"+b+")"};a.prototype.$8=function(a){"use strict";return"(?:"+a+"{4,})"};a.prototype.getMainMatcher=function(){"use strict";return this.$10};a.prototype.getTriggerMatcher=function(){"use strict";return this.$9};a.prototype.getAutoMatcher=function(){"use strict";return this.$12};a.prototype.getHashtagMatcher=function(){"use strict";return this.$13};f="\\b[A-Z][^ A-Z"+c+"]";b={mentionsMatchers:new a(b,c),hashtagMatchers:new a(g,d),userMatcher:new RegExp("(?:"+f+"{4,})$")};e.exports=b}),null);
__d("htmlize",["htmlSpecialChars"],(function(a,b,c,d,e,f){function a(a){return b("htmlSpecialChars")(a).replace(/\r\n|[\r\n]/g,"<br/>")}e.exports=a}),null);
__d("MentionsInput",["cx","Arbiter","ArbiterMixin","Bootloader","CSS","DataStore","DOM","Event","FbtResultBase","FlipDirection","Input","InputSelection","Keys","MentionsInputMatchers","Parent","Style","TokenizeUtil","UserAgent_DEPRECATED","htmlize","mixin","removeFromArray"],(function(a,b,c,d,e,f,g){__p&&__p();var h,i="\u200b",j=new RegExp(i,"g"),k=function(a){return a+i},l=function(a){return a.replace(/(@+)(\[[0-9]+\:([^\]]|\\\])*\]+)/g,"$1 $2")},m=/[\\\]:]/g,n={MENTIONS:"mentions",HASHTAGS:"hashtags"};function o(a,b){return a.replace(b," ".repeat(b.length))}function p(a,b){return a.substring(0,b)+a.substring(b+1)}function q(a){var b=a.lastIndexOf(">");if(b>=0){b=a.indexOf(" ",b);return b>=0?a.substr(0,b+1):a}else return""}function r(a,b,c){a=c.lastIndexOf("<",b)>c.lastIndexOf(">",b);return a?" ":"&nbsp;<wbr />"}c=babelHelpers.inherits(a,b("mixin")(b("ArbiterMixin")));h=c&&c.prototype;function a(a,c,d,e,f,g){"use strict";__p&&__p();h.constructor.call(this);b("DataStore").set(a,"MentionsInput",this);this._root=a;this._typeahead=c;this._input=d;this._offsets=[];a=null;var i=this.init.bind(this,e,f,g);try{a=document.activeElement===this._input}catch(a){}if(a)setTimeout(i,0);else var j=b("Event").listen(this._input,"focus",function(){setTimeout(i,0),j.remove()});this._hasHashtags=e.hashtags;this._mentionsDataSource=this._typeahead.getData();this._currentDataSource=this._mentionsDataSource;this._autoSuggestPages=e.autosuggest_pages;this._lastHighlighterHTML="";this._hashtags=[];this._matchers=b("MentionsInputMatchers").mentionsMatchers;this._matchersMode=n.MENTIONS}a.prototype.init=function(a,c,d){"use strict";__p&&__p();if(this._initialized)return;this._initValue=c?c.value:"";this._highlighter=b("DOM").find(this._root,".highlighter");this._highlighterInner=this._highlighter.firstChild;this._highlighterContent=b("DOM").find(this._root,".highlighterContent");this._hiddenInput=b("DOM").find(this._root,".mentionsHidden");this._placeholder=this._input.getAttribute("placeholder")||"";this._metrics=d;if(!this._hiddenInput.name){a=this._input.name;this._input.name=a+"_text";this._hiddenInput.name=a}this._initEvents();this._initTypeahead();c===null?this._setup():this.reset(c);this.inform("init",null,"state");this._initialized=!0};a.prototype._setup=function(){"use strict";this._mentioned={},this._orderedUIDs=[],this._numMentioned=0,this._filterData=null,this._highlighterContent&&b("DOM").empty(this._highlighterContent),this._highlighterAuxContent&&b("DOM").remove(this._highlighterAuxContent),this._highlighterAuxContent=null,b("Input").setPlaceholder(this._input,this._placeholder),b("Style").set(this._typeahead.getElement(),"height","auto")};a.prototype.reset=function(a){"use strict";__p&&__p();this._setup();var c=a&&a.value||"";this._value=c;this._hiddenInput&&(this._hiddenInput.value=c);this._input&&a&&b("Input").setValue(this._input,a.value);a=a&&a.mentions;if(a&&a.length){var d=[];a.forEach(function(a){d.push(a.offset+a.length),delete a.offset,delete a.length,this._addToken(a)},this);d.reverse().forEach(function(a){c=c.substring(0,a)+i+c.substring(a)})}b("Input").setValue(this._input,c);this._value===""&&b("FlipDirection").setDirection(this._input);this._update()};a.prototype.getValue=function(){"use strict";return b("Input").getValue(this._input).replace(j,"")};a.prototype._getMarkedValue=function(){"use strict";return b("Input").getValueRaw(this._input)};a.prototype.getRawValue=function(){"use strict";this._update();return b("Input").getValue(this._hiddenInput)};a.prototype.checkValue=function(){"use strict";var a=this._typeahead.getCore().getValue();(this._matchers.getTriggerMatcher().exec(a)||a==="")&&this.inform("sessionEnd",{})};a.prototype.getTypeahead=function(){"use strict";return this._typeahead};a.prototype.hasChanges=function(){"use strict";return!b("Input").isEmpty(this._input)&&this._input.value!==this._initValue&&this._initialized};a.prototype.focus=function(){"use strict";this._input.focus()};a.prototype._initEvents=function(){"use strict";var a=this._update.bind(this);b("Event").listen(this._input,{input:a,keyup:a,change:a,blur:this._handleBlur.bind(this),focus:this._handleFocus.bind(this),keydown:this._handleKeydown.bind(this)});this._metrics&&(this._metrics.init(this._typeahead),this._metrics._reset(),this._metrics.bindSessionStart(this._typeahead,"render",!0),this._metrics.bindSessionEnd(this._typeahead.getView(),"select",!0),this._metrics.bindSessionEnd(this,"sessionEnd",!1),b("Event").listen(this._input,"keyup",function(event){setTimeout(this.checkValue.bind(this),0)}.bind(this)))};a.prototype._initTypeahead=function(){"use strict";__p&&__p();this._typeahead.subscribe("select",function(a,b){a=b.selected;this._addToken({uid:a.uid,text:a.text,type:a.type,weakreference:a.weak_reference});this.updateValue()}.bind(this));var a=this._input,c=null;function d(){c===null&&(c=b("Input").getSubmitOnEnter(a),b("Input").setSubmitOnEnter(a,!1))}function e(){c!==null&&(b("Input").setSubmitOnEnter(a,c),c=null)}this._typeahead.subscribe("reset",e);this._typeahead.subscribe("render",d);this._typeahead.subscribe("highlight",function(a,b){b.index>=0?d():e()});this._typeahead.subscribe("query",function(){this._filterData=null}.bind(this));var f=this._typeahead.getCore();f.suffix=i;this._handleFocus()};a.prototype._handleBlur=function(){"use strict";this._filterToken&&(this._filterToken.remove(),this._filterToken=null)};a.prototype._handleFocus=function(){"use strict";this._filterToken||(this._filterToken=this._typeahead.getData().addFilter(this._filterResults.bind(this))),this._updateWidth()};a.prototype._handleKeydown=function(event){"use strict";var a=event.keyCode;(a==b("Keys").BACKSPACE||a==b("Keys").DELETE)&&this._handleBackspaceAndDelete(event,a);(a==b("Keys").LEFT||a==b("Keys").RIGHT)&&setTimeout(this._handleLeftAndRight.bind(this,a),10)};a.prototype._handleLeftAndRight=function(a){"use strict";__p&&__p();var c=this._getMarkedValue(),d=b("InputSelection").get(this._input),e=d.start;d=d.end;var f=a==b("Keys").LEFT;a=a==b("Keys").RIGHT;if(e==d){var g=f?-1:1;c.charAt(e)==i&&b("InputSelection").set(this._input,e+g)}else f&&c.charAt(e)==i?b("InputSelection").set(this._input,e-1,d):f&&c.charAt(d)==i?b("InputSelection").set(this._input,e,d-1):a&&c.charAt(d)==i?b("InputSelection").set(this._input,e,d+1):a&&c.charAt(e)==i&&b("InputSelection").set(this._input,e+1,d)};a.prototype._handleBackspaceAndDelete=function(event,a){"use strict";__p&&__p();var c=b("InputSelection").get(this._input),d=!1;if(c.start!==c.end)if(this._offsetIsInsideMention(c.start+1)&&this._offsetIsInsideMention(c.end))d=a===b("Keys").BACKSPACE;else return;a=a===b("Keys").DELETE?1:-1;a=a+(d?c.end:c.start);d=this._getMarkedValue();c=d;for(var e=0;e<this._orderedUIDs.length;++e){var f=this._mentioned[this._orderedUIDs[e]],g=f.text,h=k(g),i=c.indexOf(h),j=i+h.length;if(a<i||a>=j){c=o(c,h);continue}var l,m;f.type!="user"?(l=0,m=[g]):(l=h.substring(0,a-i).split(" ").length-1,m=g.split(" "));h=m.splice(l,1)[0];g=m.join(" ");m=l===0?i:j-h.length-1;g?(f.text=g,g=k(g)):this._removeToken(f.uid);l=d.substring(0,i)+g+d.substring(j);b("Input").setValue(this._input,l);b("InputSelection").set(this._input,m);this._update();event.kill();break}};a.prototype._offsetIsInsideMention=function(a){"use strict";for(var b=0;b<this._offsets.length;b++)if(a>this._offsets[b][0]&&a<=this._offsets[b][1])return!0;return!1};a.prototype._filterResults=function(a){"use strict";__p&&__p();if(this._filterData===null){var c=b("InputSelection").get(this._input).start;if(this._offsetIsInsideMention(c)){this._filterData={caretIsInsideMention:!0};return!1}c=this._typeahead.getCore();this._filterData={value:c.getValue(),rawValue:c.getRawValue()}}if(this._filterData.caretIsInsideMention)return!1;if(this._matchers.getMainMatcher().test(this._filterData.rawValue))return!0;if(a.type!="user"&&!a.connected_page)return!1;if(a.disable_autosuggest)return!1;return this._matchersMode===n.MENTIONS&&b("MentionsInputMatchers").userMatcher.test(this._filterData.value)?!0:b("TokenizeUtil").isExactMatch(this._filterData.value,this._typeahead.getData().getTextToIndex(a))};a.prototype._addToken=function(a){"use strict";__p&&__p();var b=a.uid;if(!Object.prototype.hasOwnProperty.call(this._mentioned,b)){this._mentioned[b]=a;a=this._orderedUIDs;var c=l(this._getMarkedValue()),d=c.indexOf(k(this._mentioned[b].text)),e=!1,f=0;for(var g=0;g<a.length;++g){var h=k(this._mentioned[a[g]].text),i=c.indexOf(h,f);f=i+h.length;if(d<i){this._orderedUIDs.splice(g,0,b);e=!0;break}}e||this._orderedUIDs.push(b);this._numMentioned++;this._update()}};a.prototype._removeToken=function(a){"use strict";Object.prototype.hasOwnProperty.call(this._mentioned,a)&&(delete this._mentioned[a],b("removeFromArray")(this._orderedUIDs,a),this._numMentioned--,this._update())};a.prototype._update=function(a){"use strict";__p&&__p();a||({});a=this._getMarkedValue();this._checkShouldSwapDataSource(a);if(a==this._value)return;this._value=a;this._updateTypeahead();this._updateMentions();this._updateWidth();setTimeout(this._updateDirection.bind(this),0);this.updateValue();var b=this.hasAuxContent(),c=this._hiddenInput.value;this.inform("valueUpdate",{value:a,hasAuxContent:b,textWithMentions:c})};a.prototype._updateMentions=function(){"use strict";__p&&__p();this._offsets=[];var a=this._getMarkedValue(),c=a;for(var d=0;d<this._orderedUIDs.length;++d){var e=this._orderedUIDs[d],f=k(this._mentioned[e].text),g=c.indexOf(f);g==-1&&this._removeToken(e);c=o(c,f);this._offsets.push([g,g+f.length])}e=a;while((g=c.indexOf(i))>-1)e=p(e,g),c=p(c,g);if(a!==e){f=b("InputSelection").get(this._input);b("Input").setValue(this._input,e);b("InputSelection").set(this._input,f.start);this._value=e}};a.prototype._renderHashtags=function(a){"use strict";__p&&__p();this._initHashtagParser(a);if(!this._hasHashtags||!this._hashtagParser)return b("htmlize")(a);this._hashtags=this._hashtagParser.parse(a);var c=[],d=0;for(var e=0;e<this._hashtags.length;e++){var f=this._hashtags[e];c.push(b("htmlize")(a.substring(d,f.rawOffset)),"<b>",f.marker,f.tag,"</b>");d=f.rawOffset+f.marker.length+f.tag.length}c.push(b("htmlize")(a.substring(d)));return c.join("")};a.prototype.updateValue=function(){"use strict";__p&&__p();var a=this._value=this._getMarkedValue(),c=this._orderedUIDs,d=l(a);for(var e=0;e<c.length;++e){var f="@["+c[e]+":]",g=k(this._mentioned[c[e]].text);d=d.replace(g,f);a=a.replace(g,f)}g=this._renderHashtags(a);for(var e=0;e<c.length;++e){f=c[e];a=this._mentioned[f];var h=a.text;a=a.weakreference?'<b class="weak">':"<b>";g=g.replace("@["+f+":]",a+b("htmlize")(k(h))+"</b>");h=h.replace(m,function(a){return"\\"+a});d=d.replace("@["+f+":]","@["+f+":"+h+"]")}a=q(g);(this._highlighterAuxContent||a!==this._lastHighlighterHTML)&&(b("UserAgent_DEPRECATED").ie()<9&&(g=g.replace(/ /g,r)),this._highlighterContent.innerHTML=g,this._updateHighlighter(),this._lastHighlighterHTML=a);this._hiddenInput.value=d;this._updateHeight()};a.prototype._updateDirection=function(){"use strict";var a=b("Style").get(this._input,"direction");if(a==this._dir)return;this._dir=a;b("Style").set(this._highlighter,"direction",a);a=="rtl"?b("Style").set(this._highlighter,"text-align","right"):b("Style").set(this._highlighter,"text-align","left")};a.prototype._updateWidth=function(){"use strict";var a=this._input.offsetWidth;if(a===this._lastInputWidth)return;this._lastInputWidth=a;var c=b("Style").getFloat.bind(null,this._input);a=a-c("paddingLeft")-c("paddingRight")-c("borderLeftWidth")-c("borderRightWidth");this._highlighterInner.style.width=Math.max(a,0)+"px"};a.prototype._updateHeight=function(){"use strict";if(this._highlighterAuxContent){var a=this._highlighter.offsetHeight,c=this._typeahead.getElement();a>c.offsetHeight&&(this._typeahead.setHeight(a),b("Arbiter").inform("reflow"))}};a.prototype._updateTypeahead=function(){"use strict";var a=this._typeahead.getCore();a.matcher=this._matchers.getAutoMatcher();a.setExclusions(this._orderedUIDs);this.inform("update",{mentioned:this._mentioned})};a.prototype.setPlaceholder=function(a){"use strict";this._placeholder=a instanceof b("FbtResultBase")?a.toString():a,this.hasAuxContent()||b("Input").setPlaceholder(this._input,this._placeholder)};a.prototype._updateHighlighter=function(){"use strict";this._highlighterContent&&b("CSS").conditionShow(this._highlighterContent,this._numMentioned>0||this.hasAuxContent()||this._hashtags.length)};a.prototype.setAuxContent=function(a){"use strict";this._highlighterContent&&(this._highlighterAuxContent||(this._highlighterAuxContent=b("DOM").create("span",{className:"highlighterAuxContent"}),b("DOM").insertAfter(this._highlighterContent,this._highlighterAuxContent)),b("DOM").setContent(this._highlighterAuxContent,a),a?b("Input").setPlaceholder(this._input,""):b("Input").setPlaceholder(this._input,this._placeholder),this._value=null,this._update(),this._updateHighlighter(),this._updateHeight())};a.prototype.hasAuxContent=function(){"use strict";var a=this.getAuxContentRoot();return a&&b("CSS").shown(a)&&a.innerHTML.length>0};a.prototype.getAuxContentRoot=function(){"use strict";return this._highlighterAuxContent};a.prototype.addMention=function(a,c){"use strict";c=typeof c==="undefined"?!0:c;c=c===!1?"":" ";var d=this._getMarkedValue();d!==""&&(d+=" ");b("Input").setValue(this._input,d+k(a.text)+c);this._addToken(a);this._update()};a.prototype.getMentions=function(){"use strict";return this._mentioned};a.prototype.bootloadHashtagParser=function(){"use strict";this._hashtagParser||b("Bootloader").loadModules(["HashtagParser"],function(a){this._hashtagParser=a,this._initialized&&(this._value=null,this._update())}.bind(this),"MentionsInput")};a.getInstance=function(a){"use strict";a=b("Parent").byClass(a,"uiMentionsInput");return a?b("DataStore").get(a,"MentionsInput"):null};a.prototype._checkShouldSwapDataSource=function(a){"use strict";this._initHashtagParser(a)};a.prototype._initHashtagParser=function(a){"use strict";if(this._hashtagParser)return;this._matchers.getHashtagMatcher().exec(a)&&this.bootloadHashtagParser()};e.exports=a}),null);
__d("legacy:MentionsInput",["MentionsInput"],(function(a,b,c,d,e,f){a.MentionsInput=b("MentionsInput")}),3);
__d("TypeaheadAreaCore",["InputSelection","TextAreaControl","TypeaheadCore","emptyFunction"],(function(a,b,c,d,e,f){__p&&__p();var g;c=babelHelpers.inherits(a,b("TypeaheadCore"));g=c&&c.prototype;function a(a){"use strict";g.constructor.call(this,a),this.matcher=new RegExp(this.matcher+"$"),this.preventFocusChangeOnTab=!0}a.prototype.select=function(a){"use strict";g.select.call(this,a);var c=this.element.value;a=this.prefix+a.text+this.suffix;this.expandBounds(c,a);var d=c.substring(0,this.start);c=c.substring(this.end);this.element.value=d+a+c;b("InputSelection").set(this.element,d.length+a.length)};a.prototype.expandBounds=function(a,b){"use strict";__p&&__p();a=a.toLowerCase();b=b.toLowerCase();var c,d,e,f,g=/\s/;d=a.substring(this.start,this.end);e=b.indexOf(d);c=this.start;while(c>=0&&e>=0)f=a.charAt(c-1),(!f||g.test(f))&&(this.start=c),d=f+d,e=b.indexOf(d),c--;d=a.substring(this.start,this.end);e=b.indexOf(d);c=this.end;while(c<=a.length&&e>=0)f=a.charAt(c),(!f||g.test(f))&&(this.end=c),d=d+f,e=b.indexOf(d),c++};a.prototype.getRawValue=function(){"use strict";var a=b("InputSelection").get(this.element).start||0;return g.getValue.call(this).substring(0,a)};a.prototype.getValue=function(){"use strict";__p&&__p();var a=this.matcher&&this.matcher.exec(this.getRawValue());if(!a)return"";var b=a[0],c=a.index+b.length;b=b.replace(/^\s/,"");var d=b.length;b=b.replace(/\s$/,"");b=d-b.length;this.start=c-d;this.end=c+b;return a[2]&&(a[2].charAt(0)==="#"||a[2].charAt(0)==="\\uFF03")?a[2]:a[3]||a[1]||a[0]};a.prototype.updateHeight=function(){"use strict";var a=b("TextAreaControl").getInstance(this.element);a.updateHeight()};Object.assign(a.prototype,{prefix:"",suffix:", ",matcher:"\\b[^,]*",click:b("emptyFunction")});e.exports=a}),null);
__d("TypeaheadHoistFriends",[],(function(a,b,c,d,e,f){__p&&__p();function a(a){"use strict";this._typeahead=a}a.prototype.enable=function(){"use strict";__p&&__p();var a=this._typeahead.getView();this._subscription=a.subscribe("beforeRender",function(a,b){a=[];var c=[],d=[];for(var e=0;e<b.results.length;++e){var f=b.results[e];f.type=="header"?(d=d.concat(c,a),d.push(f),c=[],a=[]):f.type=="user"&&f.bootstrapped?c.push(f):a.push(f)}b.results=d.concat(c,a)})};a.prototype.disable=function(){"use strict";this._typeahead.getView().unsubscribe(this._subscription),this._subscription=null};Object.assign(a.prototype,{_subscription:null});e.exports=a}),null);
__d("legacy:HoistFriendsTypeaheadBehavior",["TypeaheadHoistFriends"],(function(a,b,c,d,e,f){a.TypeaheadBehaviors||(a.TypeaheadBehaviors={}),a.TypeaheadBehaviors.hoistFriends=function(a){a.enableBehavior(b("TypeaheadHoistFriends"))}}),3);
__d("TypeaheadMetrics",["AsyncRequest","Event","QueriesHistory","emptyFunction"],(function(a,b,c,d,e,f){__p&&__p();var g=1e3;function a(a){"use strict";this.extraData={},Object.assign(this,a)}a.prototype.init=function(a){"use strict";this.init=b("emptyFunction"),this._initImpl(a)};a.prototype._initImpl=function(a){"use strict";this.core=a.getCore(),this.view=a.getView(),this.data=a.getData(),this.queriesHistory=new(b("QueriesHistory"))(g),this.stats={},this.sessionActive=!1,this._sessionStartEvents=[],this._sessionEndEvents=[],this._reset(),this.initEvents()};a.prototype._reset=function(){"use strict";this.log=[],this.stats={},this.avgStats={},this.sessionActive=!1,this._setSid(Math.floor(Date.now()*Math.random())),this.request_ids=[],this.lastNotBackspacedQuery="",this.queriesHistory.reset(),this._logEvent("session_started",{})};a.prototype._logEvent=function(a,b){"use strict";a={type:a,data:b,time:Date.now()};this.log.push(a)};a.prototype._setSid=function(a){"use strict";this.sid=a,typeof this.data.queryData==="object"&&this.data.queryData!==null?this.data.queryData.sid=this.sid:this.data.setQueryData({sid:this.sid}),typeof this.data.bootstrapData==="object"&&this.data.bootstrapData!==null?this.data.bootstrapData.sid=this.sid:this.data.setBootstrapData({sid:this.sid})};a.prototype.resetWithData=function(a){"use strict";this.init=b("emptyFunction"),this._initImpl(a)};a.prototype.resetWithDataBeforeSessionEnd=function(a){"use strict";var c=this.sessionActive;this.init=b("emptyFunction");this._initImpl(a);this.sessionActive=c};a.prototype.recordSelect=function(a){"use strict";__p&&__p();var b=a.selected;b.uid==null?this.recordStat("selected_id","SELECT_NULL"):this.recordStat("selected_id",b.uid);this.recordStat("selected_type",b.type);this.recordStat("selected_score",b.score);this.recordStat("selected_original_id",b.original_id);this.recordStat("place_id",b.place_id);this.recordStat("client_time",b.client_time);this.recordStat("selected_position",a.index);this.recordStat("selected_with_mouse",a.clicked?1:0);this.recordStat("selected_query",a.query);this._sessionEnd()};a.prototype.bindSessionStart=function(a,event,b){"use strict";if(b)for(var b=0;b<this._sessionStartEvents.length;++b){var c=this._sessionStartEvents[b];c.obj.unsubscribe(c.token)}this._sessionStartEvents.push({obj:a,token:a.subscribe(event,function(a,b){this._sessionStart()}.bind(this))})};a.prototype.bindSessionEnd=function(a,event,b){"use strict";if(b)for(var b=0;b<this._sessionEndEvents.length;++b){var c=this._sessionEndEvents[b];c.obj.unsubscribe(c.token)}this._sessionEndEvents.push({obj:a,token:a.subscribe(event,function(a,b){this._sessionEnd()}.bind(this))})};a.prototype.dataSubscribe=function(a,b){"use strict";var c=this.data,d=this.data.subscribe(a,b);this._dataSubscriptions.push(function(){c.unsubscribe(d)})};a.prototype.initEvents=function(){"use strict";__p&&__p();this._dataSubscriptions=this._dataSubscriptions||[],this._dataSubscriptions.forEach(function(a){a()}),this._dataSubscriptions=[],this.bindSessionStart(this.core,"focus",!1),this.bindSessionEnd(this.core,"blur",!1),this.view.subscribe("select",function(a,b){this.recordSelect(b)}.bind(this)),this.bindSessionEnd(this.view,"select",!1),this.view.subscribe("render",function(a,b){this.results=b}.bind(this)),this.dataSubscribe("beforeQuery",function(a,b){this._logEvent("user_typed",{query:b.value});if(!b.value)return;this.query=b.value;this.queriesHistory.add(this.query);this.lastNotBackspacedQuery.indexOf(this.query)!==0&&(this.lastNotBackspacedQuery=this.query);this.recordCountStat("num_queries")}.bind(this)),this.dataSubscribe("beforeFetch",function(a,b){b.fetch_context.bootstrap?this.bootstrapBegin=Date.now():b.fetch_context.queryBegin=Date.now(),this._logEvent("async_query_started",{query:b.fetch_context.value,request_id:b.fetch_context.request_id})}.bind(this)),this.dataSubscribe("fetchComplete",function(a,b){__p&&__p();this._logEvent("async_query_completed",{query:b.fetch_context.value,request_id:b.fetch_context.request_id});if(b.fetch_context.bootstrap){this.recordAvgStat("bootstrap_latency",Date.now()-this.bootstrapBegin);var c={};b.response.payload.entries.forEach(function(a){!c[a.type]?c[a.type]=1:c[a.type]++});this.recordStat("bootstrap_response_types",c);this.bootstrapped=!0}else"filtered_count"in b.response.payload&&this.recordStat("filtered_count",b.response.payload.filtered_count),this.recordAvgStat("avg_query_latency",Date.now()-b.fetch_context.queryBegin)}.bind(this)),this.dataSubscribe("respond",function(a,b){this._logEvent("respond",{query:b.value,num_results:b.results.length});a=this.data.tokenizeBackend(b.value||"").flatValue;b=this.data.findBestPreviousQuery(a,this.data.getQueryIDs())||"";a=this.data.getQueryIDs()[b];this.normalized_backend_query=b;this.request_id=a;this.request_ids.push(a)}.bind(this)),this.dataSubscribe("dirty",function(a,b){this.bootstrapped=!1}.bind(this))};a.prototype._sessionStart=function(){"use strict";if(this.sessionActive)return;this.sessionActive=!0};a.prototype._sessionEnd=function(){"use strict";if(!this.sessionActive)return;this.sessionActive=!1;this.submit();this._reset()};a.prototype.recordStat=function(a,b){"use strict";this.stats[a]=b};a.prototype.recordCountStat=function(a){"use strict";var b=this.stats[a];this.stats[a]=b?b+1:1};a.prototype.recordAvgStat=function(a,b){"use strict";this.avgStats[a]?(this.avgStats[a][0]+=b,++this.avgStats[a][1]):this.avgStats[a]=[b,1]};a.prototype.hasStats=function(){"use strict";return!!Object.keys(this.stats).length};a.prototype.submit=function(){"use strict";__p&&__p();if("log_all_sessions"in this.extraData||this.hasStats()){Object.assign(this.stats,this.extraData);if(this.results){var a=this.results.map(function(a,b){return a.uid});this.recordStat("candidate_results",JSON.stringify(a))}this.query&&this.recordStat("query",this.query);this.lastNotBackspacedQuery&&this.recordStat("last_not_backspaced_query",this.lastNotBackspacedQuery);this.recordStat("queries_history",JSON.stringify(this.queriesHistory.getQueries()));this.normalized_backend_query&&this.recordStat("normalized_backend_query",this.normalized_backend_query);this.request_id&&this.recordStat("request_id",this.request_id);this.request_ids.length&&this.recordStat("request_ids",this.request_ids);this.sid&&this.recordStat("sid",this.sid);this.bootstrapped&&this.recordStat("bootstrapped",1);for(var c in this.avgStats){a=this.avgStats[c];this.stats[c]=a[0]/a[1]}this.recordStat("log",JSON.stringify(this.log));new(b("AsyncRequest"))().setURI(this.endPoint).setMethod("POST").setData({stats:this.stats}).setErrorHandler(b("emptyFunction")).send();this._reset()}};a.register=function(a,c,d){"use strict";if(document.activeElement===a)c.init(d);else var e=b("Event").listen(a,"focus",function(){c.init(d),e.remove()})};Object.assign(a.prototype,{endPoint:"/ajax/typeahead/record_basic_metrics.php"});e.exports=a}),null);